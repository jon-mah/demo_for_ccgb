#   # p11a + p11_l_accessory +
#   p16a + p16_l_accessory +
#   p7a + p7_l_accessory +
#   p15a + p15_l_accessory +
#   p17a + p17_l_accessory +
#   p1a + p1_l_accessory +
#   p19a + p19_l_accessory +
#   p27a + p27_l_accessory +
#   p20a + p20_l_accessory +
#   p21a + p21_l_accessory +
#   p24a + p24_l_accessory +
#   p30a + p30_l_accessory +
#   p29a + p29_l_accessory +
#   p22a + p22_l_accessory +
#   plot_layout(ncol=2)
#
# png("../Supplement/Supplemental_Figure_8.png", width = 1600, height = 16000)
# # 1600 x 16000 dimensions of saved image
# sfs_and_likelihood_accessory
# dev.off()
# Supplemental Figure 9
shared_species_list = FD_accessory_phylogenetic_levels
supplementary_demography_df = data.frame(species=supplementary_species_list,
nu_mle = numeric(39),
time_mle = numeric(39)
)
for (i in 1:length(supplementary_species_list)) {
# nu_mle
supplementary_demography_df[i, 2] = return_nu_mle(core_likelihood_surface_file_list[i])
# tau_mle
supplementary_demography_df[i, 3] = return_time_mle(core_likelihood_surface_file_list[i],
core_synonymous_sfs_file_list[i],
core_two_epoch_file_list[i])
}
supplementary_demography_df
fd_accessory_likelihood_surface_list = c(
'../SupplementaryAnalysis/Alistipes_putredinis_61533/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Alistipes_finegoldii_56071/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Alistipes_onderdonkii_55464/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Alistipes_shahii_62199/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroidales_bacterium_58650/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Parabacteroides_distasonis_56985/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Parabacteroides_merdae_56972/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_cellulosilyticus_58046/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_stercoris_56735/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_thetaiotaomicron_56941/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_caccae_53434/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_massiliensis_44749/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Bacteroides_vulgatus_57955/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Dialister_invisus_61905/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Eubacterium_eligens_61678/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Eubacterium_rectale_56927/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Eubacterium_siraeum_57634/accessory_likelihood_surface.csv',
'../SupplementaryAnalysis/Ruminococcus_bromii_62047/accessory_likelihood_surface.csv'
)
fd_accessory_sfs_list = c(
'../SupplementaryAnalysis/Alistipes_putredinis_61533/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Alistipes_finegoldii_56071/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Alistipes_onderdonkii_55464/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Alistipes_shahii_62199/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroidales_bacterium_58650/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Parabacteroides_distasonis_56985/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Parabacteroides_merdae_56972/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_cellulosilyticus_58046/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_stercoris_56735/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_thetaiotaomicron_56941/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_caccae_53434/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_massiliensis_44749/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Bacteroides_vulgatus_57955/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Dialister_invisus_61905/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Eubacterium_eligens_61678/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Eubacterium_rectale_56927/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Eubacterium_siraeum_57634/accessory_empirical_syn_downsampled_sfs.txt',
'../SupplementaryAnalysis/Ruminococcus_bromii_62047/accessory_empirical_syn_downsampled_sfs.txt'
)
fd_accessory_demography_list = c(
'../SupplementaryAnalysis/Alistipes_putredinis_61533/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Alistipes_finegoldii_56071/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Alistipes_onderdonkii_55464/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Alistipes_shahii_62199/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroidales_bacterium_58650/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Parabacteroides_distasonis_56985/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Parabacteroides_merdae_56972/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_cellulosilyticus_58046/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_stercoris_56735/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_thetaiotaomicron_56941/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_caccae_53434/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_massiliensis_44749/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Bacteroides_vulgatus_57955/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Dialister_invisus_61905/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Eubacterium_eligens_61678/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Eubacterium_rectale_56927/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Eubacterium_siraeum_57634/accessory_two_epoch_demography.txt',
'../SupplementaryAnalysis/Ruminococcus_bromii_62047/accessory_two_epoch_demography.txt'
)
accessory_demography_df = data.frame(species=shared_species_list,
nu_mle = numeric(18),
time_mle = numeric(18)
)
for (i in 1:length(shared_species_list)) {
# nu_mle
accessory_demography_df[i, 2] = return_nu_mle(fd_accessory_likelihood_surface_list[i])
# tau_mle
accessory_demography_df[i, 3] = return_time_mle(fd_accessory_likelihood_surface_list[i],
fd_accessory_sfs_list[i],
fd_accessory_demography_list[i])
}
accessory_demography_df
options(ggrepel.max.overlaps = Inf)
supplementary_demography_scatter = ggscatter(supplementary_demography_df, x="nu_mle", y="time_mle", color='species', size=3) +
ylab('Estimated time in years since most recent demographic event') +
xlab(nu_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=3) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-2, 2e5)) +
scale_y_log10(limits=c(2e2, 1e7)) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
supplementary_demography_scatter
temp_supp_df = supplementary_demography_df[which(supplementary_demography_df$species %in% shared_species_list), ]
temp_supplementary_demography_scatter = ggscatter(temp_supp_df, x="nu_mle", y="time_mle", color='species', size=3) +
ylab('Estimated time in years since most recent demographic event') +
xlab(nu_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-2, 2e5)) +
scale_y_log10(limits=c(2e2, 1e7)) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
temp_supplementary_demography_scatter
plot_build <- ggplot_build(temp_supplementary_demography_scatter)
color_mapping <- plot_build$data[[1]]$colour
print(color_mapping)
difference_plot =
temp_supplementary_demography_scatter +
geom_segment(aes(x=temp_supp_df$nu_mle, y=temp_supp_df$time_mle,
xend=accessory_demography_df$nu_mle, yend=accessory_demography_df$time_mle),
linejoin='round',
lineend='round',
linetype=1,
color=color_mapping,
arrow = arrow(length=unit(0.2, 'cm'))) +
# geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
ggtitle('Core gene to accessory gene demography')
difference_plot
# png("../Supplement/Supplemental_Figure_9.png", width = 800, height = 750)
# # 800 x 750 dimensions of saved image
# difference_plot
# dev.off()
# Supplemental Figure 10
# design = "
# ABB
# ACC
# DEE
# DFF
# GHH
# GII
# JKK
# JLL
# MNN
# MOO
# PQQ
# PRR
# STT
# SUU
# "
# p1a = plot_best_fit_sfs(a_muciniphila_best_fit_accessory) + ggtitle('Akkermansia muciniphila')
# p2a = plot_best_fit_sfs(a_finegoldii_best_fit_accessory) + ggtitle('Alistipes finegoldii')
# p3a = plot_best_fit_sfs(a_onderdonkii_best_fit_accessory) + ggtitle('Alistipes onderdonkii')
# p4a = plot_best_fit_sfs(a_putredinis_best_fit_accessory)  + ggtitle('Alistipes putredinis')
# p5a = plot_best_fit_sfs(a_shahii_best_fit_accessory) + ggtitle('Alistipes shahii')
# p6a = plot_best_fit_sfs(b_bacterium_best_fit_accessory) + ggtitle('Bacteroidales bacterium')
# p7a = plot_best_fit_sfs(b_caccae_best_fit_accessory) + ggtitle('Bacteroides caccae')
# p8a = plot_best_fit_sfs(b_cellulosilyticus_best_fit_accessory) + ggtitle('Bacteroides cellulosilyticus')
# p9a = plot_best_fit_sfs(b_fragilis_best_fit_accessory) + ggtitle('Bacteroides fragilis')
# # p10a = plot_best_fit_sfs(_best_fit_accessory)
# p11a = plot_best_fit_sfs(b_ovatus_best_fit_accessory) + ggtitle('Bacteroides ovatus')
# p12a = plot_best_fit_sfs(b_stercoris_best_fit_accessory) + ggtitle('Bacteroides stercoris')
# p13a = plot_best_fit_sfs(b_thetaiotaomicron_best_fit_accessory) + ggtitle('Bacteroides thetaiotaomicron')
# p14a = plot_best_fit_sfs(b_uniformis_best_fit_accessory) + ggtitle('Bacteroides uniformis')
# p15a = plot_best_fit_sfs(b_vulgatus_best_fit_accessory) + ggtitle('Bacteroides vulgatus')
# p16a = plot_best_fit_sfs(b_xylanisolvens_best_fit_accessory) + ggtitle('Bacteroides xylanisolvens')
# p17a = plot_best_fit_sfs(b_intestinihominis_best_fit_accessory) + ggtitle('Barnesiella intestinihominis')
# # p18a = plot_best_fit_sfs(_best_fit_accessory)
# p19a = plot_best_fit_sfs(d_invisus_best_fit_accessory) + ggtitle('Dialister invisus')
# p20a = plot_best_fit_sfs(e_eligens_best_fit_accessory) + ggtitle('Eubacterium eligens')
# p21a = plot_best_fit_sfs(e_rectale_best_fit_accessory) + ggtitle('Eubacterium rectale')
# p22a = plot_best_fit_sfs(f_prausnitzii_best_fit_accessory) + ggtitle('Faecalibacterium prausnitzii')
# p23a = plot_best_fit_sfs(o_splanchnicus_best_fit_accessory) + ggtitle('Odoribacter splanchnicus')
# p24a = plot_best_fit_sfs(oscillibacter_sp_best_fit_accessory) + ggtitle('Oscillibacter species')
# p25a = plot_best_fit_sfs(p_distasonis_best_fit_accessory) + ggtitle('Parabacteroides distasonis')
# p26a = plot_best_fit_sfs(p_merdae_best_fit_accessory) + ggtitle('Parabacteroides merdae')
# p27a = plot_best_fit_sfs(phascolarctobacterium_sp_best_fit_accessory) + ggtitle('Phascolarctobacterium species')
# p28a = plot_best_fit_sfs(p_copri_best_fit_accessory) + ggtitle('Prevotella copri')
# p29a = plot_best_fit_sfs(r_bicirculans_best_fit_accessory) + ggtitle('Ruminococcus bicirculans')
# p30a = plot_best_fit_sfs(r_bromii_best_fit_accessory) + ggtitle('Ruminococcus bromii')
#
# p1_core_dfe = plot_core_accessory_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. muciniphila, Core Genes')
# p2_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. finegoldii, Core Genes')
# p3_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. onderdonkii, Core Genes')
# p4_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. putredinis, Core Genes')
# p5_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. shahii, Core Genes')
# p6_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. bacterium, Core Genes')
# p7_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. caccae, Core Genes')
# p8_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. cellulosilyticus, Core Genes')
# p9_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. fragilis, Core Genes')
# # p10 = plot_core_accessory_dfe('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. massiliensis, Core Genes')
# p11_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. ovatus, Core Genes')
# p12_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. stercoris, Core Genes')
# p13_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
# p14_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
# p15_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. vulgatus, Core Genes')
# p16_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. xylanisolvens, Core Genes')
# p17_core_dfe = plot_core_accessory_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. intestinihominis, Core Genes')
# # p18 = plot_core_accessory_dfe('../Analysis/Coprococcus_sp_62244_downsampled_14/core_inferred_DFE.txt') + ggtitle('Coprococcus species, Core Genes')
# p19_core_dfe = plot_core_accessory_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/core_inferred_DFE.txt') + ggtitle('D. invisus, Core Genes')
# p20_core_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/core_inferred_DFE.txt') + ggtitle('E. eligens, Core Genes')
# p21_core_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
# p22_core_dfe = plot_core_accessory_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
# p23_core_dfe = plot_core_accessory_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_inferred_DFE.txt') + ggtitle('O. splanchnicus, Core Genes')
# p24_core_dfe = plot_core_accessory_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/core_inferred_DFE.txt') + ggtitle('Oscillibacter species, Core Genes')
# p25_core_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_inferred_DFE.txt') + ggtitle('P. distasonis, Core Genes')
# p26_core_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_inferred_DFE.txt') + ggtitle('P. merdae, Core Genes')
# p27_core_dfe = plot_core_accessory_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_inferred_DFE.txt') + ggtitle('Phascolarctobacterium species, Core Genes')
# p28_core_dfe = plot_core_accessory_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/core_inferred_DFE.txt') + ggtitle('P.  copri, Core Genes')
# p29_core_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_inferred_DFE.txt') + ggtitle('R. bicirculans, Core Genes')
# p30_core_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_inferred_DFE.txt') + ggtitle('R.  bromii, Core Genes')
#
# p1_acc_dfe = plot_core_accessory_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. muciniphila, Accessory Genes')
# p2_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. finegoldii, Accessory Genes')
# p3_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. onderdonkii, Accessory Genes')
# p4_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. putredinis, Accessory Genes')
# p5_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. shahii, Accessory Genes')
# p6_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. bacterium, Accessory Genes')
# p7_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. caccae, Accessory Genes')
# p8_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. cellulosilyticus, Accessory Genes')
# p9_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. fragilis, Accessory Genes')
# # p10 = plot_core_accessory_dfe('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. massiliensis, Accessory Genes')
# p11_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. ovatus, Accessory Genes')
# p12_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. stercoris, Accessory Genes')
# p13_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
# p14_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
# p15_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. vulgatus, Accessory Genes')
# p16_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. xylanisolvens, Accessory Genes')
# p17_acc_dfe = plot_core_accessory_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. intestinihominis, Accessory Genes')
# # p18 = plot_core_accessory_dfe('../Analysis/Coprococcus_sp_62244_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Coprococcus species, Accessory Genes')
# p19_acc_dfe = plot_core_accessory_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('D. invisus, Accessory Genes')
# p20_acc_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('E. eligens, Accessory Genes')
# p21_acc_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
# p22_acc_dfe = plot_core_accessory_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
# p23_acc_dfe = plot_core_accessory_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('O. splanchnicus, Accessory Genes')
# p24_acc_dfe = plot_core_accessory_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Oscillibacter species, Accessory Genes')
# p25_acc_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. distasonis, Accessory Genes')
# p26_acc_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. merdae, Accessory Genes')
# p27_acc_dfe = plot_core_accessory_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Phascolarctobacterium species, Accessory Genes')
# p28_acc_dfe = plot_core_accessory_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. copri, Accessory Genes')
# p29_acc_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('R. bicirculans, Accessory Genes')
# p30_acc_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('R. bromii, Accessory Genes')
#
# core_accessory_comparison =
#   p25a + p25_core_dfe + p25_acc_dfe +
#   p14a + p14_core_dfe + p14_acc_dfe +
#   p13a + p13_core_dfe + p13_acc_dfe +
#   p15a + p15_core_dfe + p15_acc_dfe +
#   p17a + p17_core_dfe + p17_acc_dfe +
#   p21a + p21_core_dfe + p21_acc_dfe +
#   p22a + p22_core_dfe + p22_acc_dfe +
#   plot_layout(design=design)
#
# png("../Supplement/Supplemental_Figure_10.png", width = 1200, height = 2800)
# # 1200 x 2800 dimensions of saved image
# core_accessory_comparison
# dev.off()
# Supplemental Figure 11
N_anc = table_s3$`Two.epoch..Ancestral.effective.population.size`
N_curr_low = nu_tau_distribution$`nu_low` * N_anc
N_curr_high = nu_tau_distribution$`nu_high` * N_anc
N_curr_MLE = nu_tau_distribution$`nu_mle` * N_anc
N_curr_data = data.frame(
species=FD_phylogenetic_levels,
N_curr_MLE = N_curr_MLE,
N_curr_low = N_curr_low,
N_curr_high = N_curr_high
)
N_curr_label = expression(N[current])
N_curr_data$species = factor(N_curr_data$species, levels=FD_phylogenetic_levels)
plot_N_curr_distribution = ggplot() +
geom_linerange(data=N_curr_data, mapping=aes(x=fct_rev(species), ymin=N_curr_low, ymax=N_curr_high, col=species), size=1, show.legend=FALSE) +
geom_point(data=N_curr_data, mapping=aes(x=fct_rev(species), y=N_curr_MLE, col=species), size=3, shape=18, show.legend=FALSE) +
scale_y_log10() +
coord_flip() +
theme_bw() +
xlab('') +
ylab(N_curr_label) +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(axis.text=element_text(size=16)) +
theme(axis.title=element_text(size=16,face="bold"))
png("../Supplement/Supplemental_Figure_11A.png", width = 800, height = 1200)
# 800 x 1200 dimensions of saved image
plot_N_curr_distribution
dev.off()
# Supplemental Figure 12
#
# species_list = c('A. muciniphila',
#                  'A. finegoldii',
#                  'A. onderdonkii',
#                  'A. putredinis',
#                  'A. shahii',
#                  'B. bacterium',
#                  'B. caccae',
#                  'B. cellulosilyticus',
#                  'B. fragilis',
#                  'B. ovatus',
#                  'B. stercoris',
#                  'B. thetaiotaomicron',
#                  'B. uniformis',
#                  'B. vulgatus',
#                  'B. xylanisolvens',
#                  'B. intestinihominis',
#                  'D. invisus',
#                  'E. eligens',
#                  'E. rectale',
#                  'F. prausnitzii',
#                  'O. splanchnicus',
#                  'Oscillibacter species',
#                  'P. distasonis',
#                  'P. merdae',
#                  'Phasolarctobacterium species',
#                  'P. copri',
#                  'R. bicirculans',
#                  'R. bromii')
#
# num_qp_samples = c(25, 45, 62, 41, 58,
#                    31, 35, 35, 31,
#                    51, 71, 67, 88, 44,
#                    50, 50, 36, 25,
#                    74, 30, 32, 47, 40,
#                    43, 17, 15, 71, 36)
#
# core_qp_samples_per_species_csv =
# 'Akkermansia_muciniphila_55200, 25
# Alistipes_finegoldii_56071, 45
# Alistipes_onderdonkii_55464, 62
# Alistipes_putredinis_61533, 41
# Alistipes_shahii_62199, 58
# Bacteroidales_bacterium_58650, 31
# Bacteroides_caccae_53434, 35
# Bacteroides_cellulosilyticus, 35
# Bacteroides_fragilis_5507, 31
# Bacteroides_massiliensis_44749, 13
# Bacteroides_stercoris, 71
# Bacteroides_thetaiotaomicron_56941, 67
# Bacteroides_uniformis_57318, 88
# Bacteroides_vulgatus_57955, 44
# Bacteroides_xylanisolvens_57185, 50
# Barnesiella_intestinihominis_62208, 50
# Coprococcus_sp_62244, 10
# Dialest_invisus_61905, 36
# Eubacterium_eligens_61678, 25
# Eubacterium_rectale_56927, 74
# Faecalibacterium_prausnitzii_57453, 30
# Odoribacter_splanchnicus_62174, 32
# Oscillibacter_sp_60799, 47
# Parabacteroides_distasonis_56985, 40
# Parabacteroides_merdae_56972, 43
# Phasolarctobacterium_sp_59817, 17
# Prevotella_copri_61740, 15
# Ruminococcus_bicirculans_59300, 71
# Ruminococcus_bromii_62047, 36
# '
#
# qp_samples_per_species = data.frame(species_list, as.numeric(num_qp_samples))
#
# png("../Supplement/Supplemental_Figure_12.png", width = 800, height = 1200)
# ggplot(qp_samples_per_species, aes(x = reorder(species_list, num_qp_samples), y = num_qp_samples)) +  geom_bar(stat='identity', fill='grey') +
#   theme(legend.position = "none") +
#   coord_flip() +
#   xlab('Species') +
#   ylab('Number of Quasi-phaseable samples') +
#   ggtitle('Number of Quasi-phaseable samples per species from core genes')  +
#   theme_bw() + theme(panel.border = element_blank(),
#                      panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
#   theme(legend.position = "none")  +
#   geom_hline(yintercept=14, linetype="dashed", color = "red") +
#   theme(axis.text.y=element_text(face="italic")) +
#   scale_y_continuous(breaks = seq(0, 90, by = 5))
# dev.off()
# Supplemental Figure 13
# accessory_core_demography = data.frame(species=phylogenetic_levels,
#   core_nu = numeric(39),
#   core_years = numeric(39),
#   core_na = numeric(39),
#   acc_nu = numeric(39),
#   acc_years = numeric(39),
#   acc_na = numeric(39))
#
# accessory_core_two_epoch_file_list = c(
#   '../Analysis/Bacteroidales_bacterium_58650_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Alistipes_putredinis_61533_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Alistipes_finegoldii_56071_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Alistipes_onderdonkii_55464_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Alistipes_shahii_62199_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Parabacteroides_distasonis_56985_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Parabacteroides_merdae_56972_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Prevotella_copri_61740_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_fragilis_54507_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_stercoris_56735_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_uniformis_57318_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_caccae_53434_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Bacteroides_vulgatus_57955_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Akkermansia_muciniphila_55290_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Dialister_invisus_61905_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Eubacterium_eligens_61678_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Eubacterium_rectale_56927_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Oscillibacter_sp_60799_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Ruminococcus_bromii_62047_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/accessory_two_epoch_demography.txt',
#   '../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/accessory_two_epoch_demography.txt'
# )
#
# for (i in 1:length(core_two_epoch_file_list)) {
#   accessory_core_demography[i, 2:4] = read_demography_info(core_two_epoch_file_list[i])
#   accessory_core_demography[i, 5:7] = read_demography_info(accessory_core_two_epoch_file_list[i])
# }
#
# colnames(accessory_core_demography) = c('Species',
#   'Core, Nu',
#   'Core, Years',
#   'Core, N_anc',
#   'Accessory, Nu',
#   'Accessory, Years',
#   'Accessory, N_Anc')
# write.csv(accessory_core_demography, '../Summary/accessory_core_demography_comparison.csv', row.names=FALSE)
# accessory_core_demography$`Accessory, N_Anc`
# accessory_core_demography[c(7, 13, 14, 17, 18, 22, 23, 27), ]
# accessory_core_demography_reduced = accessory_core_demography[c(7, 13, 14, 17, 18, 23, 27), ]
#
# accessory_core_demography_reduced$`Core, N_anc`
# accessory_core_demography_reduced$`Accessory, N_Anc`
#
# accessory_core_demography_scatter = ggscatter(accessory_core_demography_reduced, x="Core, N_anc", y="Accessory, N_Anc", color="Species", shape=18, size=4) +
#   ylab('Estimated current effective population size') +
#   xlab('species accessory_core_demography') +
#   geom_text_repel(aes(label = Species, color=Species, fontface = 'italic'), size=3) +
#   guides(color=guide_legend(title="species")) +
#   theme(legend.position = 'none') +
#   guides(color = 'none') +
#   guides(shape = 'none')  +
#   theme(axis.text=element_text(size=12),
#     axis.title=element_text(size=16)) +
#   ylim(0, 3E7) +
#   xlim(0, 3E7) +
#   xlab('Ancestral effective population size, Accessory genes') +
#   ylab('Ancestral effective population size, Core genes') +
#   geom_abline(slope = 1, intercept = 0, color = "red", linetype = "dashed")
#
# png("../Supplement/Supplemental_Figure_13.png", width = 800, height = 800)
# accessory_core_demography_scatter
# dev.off()
table_s3
min(table_s3$Two.epoch..nu)
max(table_s3$Two.epoch..nu)
table_s3$Two.epoch..nu
table_s3$Two.epoch..nu > 1
sum(table_s3$Two.epoch..nu > 1)
sum(table_s3$Two.epoch..nu < 1)
sum(table_s3$Two.epoch..nu > 100)
table_s3
sum(table_s3$Two.epoch..nu < 1)
sum(table_s3$Two.epoch..nu <= 1)
sum(table_s3$Two.epoch..nu == 1)
sum(table_s3$Two.epoch..nu < 1)
table_s3[c(1, 8), ]
table_s3[, c(1, 8)]
table_s3[, c(1, 10)]
min(table_s3$Two.epoch..time.in.years)
sort(table_s3$Two.epoch..time.in.years)
plot_AIC = ggplot(data=plot_AIC_table) +
geom_jitter(mapping=aes(x=Species, y=AIC, colour=Model, fill=Model), size=2, shape=21, width = 0.15) +
scale_y_log10() +
# coord_flip() +
theme_bw() +
xlab('') +
ylab('Aikake information criteria') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(axis.text=element_text(size=16)) +
theme(axis.title=element_text(size=16,face="bold")) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# 1600 x 900 dimensions for saved image
plot_AIC
