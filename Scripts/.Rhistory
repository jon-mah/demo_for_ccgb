b_massiliensis_FD_neugamma) +
ggtitle('Bacteroides massiliensis (FD) DFE model fit')
compare_dfe_sfs(b_ovatus_FD_nonsyn,
b_ovatus_FD_gamma,
b_ovatus_FD_neugamma) +
ggtitle('Bacteroides ovatus (FD) DFE model fit')
compare_dfe_sfs(b_plebeius_FD_nonsyn,
b_plebeius_FD_gamma,
b_plebeius_FD_neugamma) +
ggtitle('Bacteroides plebeius (FD) DFE model fit')
compare_dfe_sfs(b_stercoris_FD_nonsyn,
b_stercoris_FD_gamma,
b_stercoris_FD_neugamma) +
ggtitle('Bacteroides stercoris (FD) DFE model fit')
compare_dfe_sfs(b_thetaiotaomicron_FD_nonsyn,
b_thetaiotaomicron_FD_gamma,
b_thetaiotaomicron_FD_neugamma) +
ggtitle('Bacteroides thetaiotaomicron (FD) DFE model fit')
compare_dfe_sfs(b_uniformis_FD_nonsyn,
b_uniformis_FD_gamma,
b_uniformis_FD_neugamma) +
ggtitle('Bacteroides uniformis (FD) DFE model fit')
compare_dfe_sfs(b_vulgatus_FD_nonsyn,
b_vulgatus_FD_gamma,
b_vulgatus_FD_neugamma) +
ggtitle('Bacteroides vulgatus (FD) DFE model fit')
compare_dfe_sfs(b_xylanisolvens_FD_nonsyn,
b_xylanisolvens_FD_gamma,
b_xylanisolvens_FD_neugamma) +
ggtitle('Bacteroides xylanisolvens (FD) DFE model fit')
compare_dfe_sfs(b_intestinihominis_FD_nonsyn,
b_intestinihominis_FD_gamma,
b_intestinihominis_FD_neugamma) +
ggtitle('Barnesiella intestinihominis (FD) DFE model fit')
compare_dfe_sfs(coprococcus_sp_FD_nonsyn,
coprococcus_sp_FD_gamma,
coprococcus_sp_FD_neugamma) +
ggtitle('Coprococcus sp. (FD) DFE model fit')
compare_dfe_sfs(d_invisus_FD_nonsyn,
d_invisus_FD_gamma,
d_invisus_FD_neugamma) +
ggtitle('Dialister invisus (FD) DFE model fit')
compare_dfe_sfs(e_eligens_FD_nonsyn,
e_eligens_FD_gamma,
e_eligens_FD_neugamma) +
ggtitle('Eubacterium eligens (FD) DFE model fit')
compare_dfe_sfs(e_rectale_FD_nonsyn,
e_rectale_FD_gamma,
e_rectale_FD_neugamma) +
ggtitle('Eubacterium rectale (FD) DFE model fit')
compare_dfe_sfs(e_siraeum_FD_nonsyn,
e_siraeum_FD_gamma,
e_siraeum_FD_neugamma) +
ggtitle('Eubacterium siraeum (FD) DFE model fit')
compare_dfe_sfs(f_prausnitzii_57453_FD_nonsyn,
f_prausnitzii_57453_FD_gamma,
f_prausnitzii_57453_FD_neugamma) +
ggtitle('Faecalibacterium prausnitzii 57453 (FD) DFE model fit')
compare_dfe_sfs(f_prausnitzii_61481_FD_nonsyn,
f_prausnitzii_61481_FD_gamma,
f_prausnitzii_61481_FD_neugamma) +
ggtitle('Faecalibacterium prausnitzii 61481 (FD) DFE model fit')
compare_dfe_sfs(f_prausnitzii_62201_FD_nonsyn,
f_prausnitzii_62201_FD_gamma,
f_prausnitzii_62201_FD_neugamma) +
ggtitle('Faecalibacterium prausnitzii 62201 (FD) DFE model fit')
compare_dfe_sfs(l_bacterium_FD_nonsyn,
l_bacterium_FD_gamma,
l_bacterium_FD_neugamma) +
ggtitle('Lachnospiraceae bacterium (FD) DFE model fit')
compare_dfe_sfs(o_splanchnicus_FD_nonsyn,
o_splanchnicus_FD_gamma,
o_splanchnicus_FD_neugamma) +
ggtitle('Odoribacter splanchnicus (FD) DFE model fit')
compare_dfe_sfs(oscillibacter_sp_FD_nonsyn,
oscillibacter_sp_FD_gamma,
oscillibacter_sp_FD_neugamma) +
ggtitle('Oscillibacter sp. (FD) DFE model fit')
compare_dfe_sfs(p_distasonis_FD_nonsyn,
p_distasonis_FD_gamma,
p_distasonis_FD_neugamma) +
ggtitle('Parabacteroides distasonis (FD) DFE model fit')
compare_dfe_sfs(p_merdae_FD_nonsyn,
p_merdae_FD_gamma,
p_merdae_FD_neugamma) +
ggtitle('Parabacteroides merdae (FD) DFE model fit')
compare_dfe_sfs(phascolarctobacterium_sp_FD_nonsyn,
phascolarctobacterium_sp_FD_gamma,
phascolarctobacterium_sp_FD_neugamma) +
ggtitle('Phascolarctobacterium sp. (FD) DFE model fit')
compare_dfe_sfs(p_copri_FD_nonsyn,
p_copri_FD_gamma,
p_copri_FD_neugamma) +
ggtitle('Prevotella copri (FD) DFE model fit')
compare_dfe_sfs(r_intestinalis_FD_nonsyn,
r_intestinalis_FD_gamma,
r_intestinalis_FD_neugamma) +
ggtitle('Roseburia intestinalis (FD) DFE model fit')
compare_dfe_sfs(r_inulinivorans_FD_nonsyn,
r_inulinivorans_FD_gamma,
r_inulinivorans_FD_neugamma) +
ggtitle('Roseburia inulinivorans (FD) DFE model fit')
compare_dfe_sfs(r_bicirculans_FD_nonsyn,
r_bicirculans_FD_gamma,
r_bicirculans_FD_neugamma) +
ggtitle('Ruminococcus bicirculans (FD) DFE model fit')
compare_dfe_sfs(r_bromii_FD_nonsyn,
r_bromii_FD_gamma,
r_bromii_FD_neugamma) +
ggtitle('Ruminococcus bromii (FD) DFE model fit')
### FD vs. HR
temp_supp_df = supplementary_demography_df[which(supplementary_demography_df$species %in% shared_species_list), ]
temp_supplementary_demography_scatter = ggscatter(temp_supp_df, x="nu_mle", y="time_mle", color='species', size=3) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-2, 2e5)) +
scale_y_log10(limits=c(2e2, 1e7)) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
temp_supplementary_demography_scatter
plot_build <- ggplot_build(temp_supplementary_demography_scatter)
color_mapping <- plot_build$data[[1]]$colour
print(color_mapping)
difference_plot =
temp_supplementary_demography_scatter +
geom_segment(aes(x=temp_supp_df$nu_mle, y=temp_supp_df$time_mle,
xend=hr_demography_df$nu_mle, yend=hr_demography_df$time_mle),
linejoin='round',
lineend='round',
linetype=1,
color=color_mapping,
arrow = arrow(length=unit(0.2, 'cm'))) +
# geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
ggtitle('Change in demography from full data to high recombination')
difference_plot
shared_species_df = data.frame(species=shared_species_list,
HR_nu_mle = numeric(18),
FD_nu_mle = numeric(18),
HR_time_mle = numeric(18),
FD_time_mle = numeric(18),
HR_nanc = numeric(18),
FD_nanc = numeric(18),
HR_shape = numeric(18),
FD_shape = numeric(18),
HR_scale = numeric(18),
FD_scale = numeric(18),
HR_mean_s = numeric(18),
FD_mean_s = numeric(18)
)
for (i in 1:length(shared_species_list)) {
# nu_mle
## HR
shared_species_df[i, 2] = return_nu_mle(hr_likelihood_surface_list[i])
## FD
shared_species_df[i, 3] = return_nu_mle(fd_likelihood_surface_list[i])
# tau_mle
## HR
shared_species_df[i, 4] = return_time_mle(hr_likelihood_surface_list[i],
hr_sfs_list[i],
hr_demography_file_list[i])
## FD
shared_species_df[i, 5] = return_time_mle(fd_likelihood_surface_list[i],
fd_sfs_list[i],
fd_demography_file_list[i])
# Nanc
## HR
shared_species_df[i, 6] = nanc_from_demography(hr_demography_file_list[i])
## FD
shared_species_df[i, 7] = nanc_from_demography(fd_demography_file_list[i])
# shape
## HR
shared_species_df[i, 8] = return_shape_from_dfe(hr_dfe_file_list[i])
## FD
shared_species_df[i, 9] = return_shape_from_dfe(fd_dfe_file_list[i])
# scale
## HR
shared_species_df[i, 10] = return_scale_from_dfe(hr_dfe_file_list[i])
## FD
shared_species_df[i, 11] = return_scale_from_dfe(fd_dfe_file_list[i])
# Mean s
## HR
shared_species_df[i, 12] = mean(read_dfe_params(hr_dfe_file_list[i])$gamma_dfe_dist_high)
## FD
shared_species_df[i, 13] = mean(read_dfe_params(fd_dfe_file_list[i])$gamma_dfe_dist_high)
}
shared_species_df
nu_mle_scatter = ggscatter(shared_species_df, x="FD_nu_mle", y="HR_nu_mle", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Nu')
nu_mle_scatter
tau_mle_scatter = ggscatter(shared_species_df, x="FD_time_mle", y="HR_time_mle", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Time (years)')
tau_mle_scatter
nanc_scatter = ggscatter(shared_species_df, x="FD_nanc", y="HR_nanc", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Effective ancestral population size')
nanc_scatter
shape_scatter = ggscatter(shared_species_df, x="FD_shape", y="HR_shape", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE shape parameter')
shape_scatter
scale_scatter = ggscatter(shared_species_df, x="FD_scale", y="HR_scale", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE scale parameter')
scale_scatter
mean_s_scatter = ggscatter(shared_species_df, x="FD_mean_s", y="HR_mean_s", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE mean selection coefficient')
mean_s_scatter
## High recombination model fit
compare_sfs(proportional_sfs(a_muciniphila_HR_folded),
proportional_sfs(a_muciniphila_HR_one_epoch),
proportional_sfs(a_muciniphila_HR_two_epoch),
proportional_sfs(a_muciniphila_HR_three_epoch)) +
ggtitle('Akkermansia muciniphila (HR) model fit')
compare_sfs(proportional_sfs(a_finegoldii_HR_folded),
proportional_sfs(a_finegoldii_HR_one_epoch),
proportional_sfs(a_finegoldii_HR_two_epoch),
proportional_sfs(a_finegoldii_HR_three_epoch)) +
ggtitle('Alistipes finegoldii (HR) model fit')
compare_sfs(proportional_sfs(a_onderdonkii_HR_folded),
proportional_sfs(a_onderdonkii_HR_one_epoch),
proportional_sfs(a_onderdonkii_HR_two_epoch),
proportional_sfs(a_onderdonkii_HR_three_epoch)) +
ggtitle('Alistipes onderdonkii (HR) model fit')
compare_sfs(proportional_sfs(a_shahii_HR_folded),
proportional_sfs(a_shahii_HR_one_epoch),
proportional_sfs(a_shahii_HR_two_epoch),
proportional_sfs(a_shahii_HR_three_epoch)) +
ggtitle('Alistipes shahii (HR) model fit')
compare_sfs(proportional_sfs(b_caccae_HR_folded),
proportional_sfs(b_caccae_HR_one_epoch),
proportional_sfs(b_caccae_HR_two_epoch),
proportional_sfs(b_caccae_HR_three_epoch)) +
ggtitle('Bacteroides caccae (HR) model fit')
compare_sfs(proportional_sfs(b_cellulosilyticus_HR_folded),
proportional_sfs(b_cellulosilyticus_HR_one_epoch),
proportional_sfs(b_cellulosilyticus_HR_two_epoch),
proportional_sfs(b_cellulosilyticus_HR_three_epoch)) +
ggtitle('Bacteroides cellulosilyticus (HR) model fit')
compare_sfs(proportional_sfs(b_coprocola_HR_folded),
proportional_sfs(b_coprocola_HR_one_epoch),
proportional_sfs(b_coprocola_HR_two_epoch),
proportional_sfs(b_coprocola_HR_three_epoch)) +
ggtitle('Bacteroides copracola (HR) model fit')
compare_sfs(proportional_sfs(b_eggerthii_HR_folded),
proportional_sfs(b_eggerthii_HR_one_epoch),
proportional_sfs(b_eggerthii_HR_two_epoch),
proportional_sfs(b_eggerthii_HR_three_epoch)) +
ggtitle('Bacteroides eggerthii (HR) model fit')
compare_sfs(proportional_sfs(b_fragilis_HR_folded),
proportional_sfs(b_fragilis_HR_one_epoch),
proportional_sfs(b_fragilis_HR_two_epoch),
proportional_sfs(b_fragilis_HR_three_epoch)) +
ggtitle('Bacteroides fragilis (HR) model fit')
compare_sfs(proportional_sfs(b_ovatus_HR_folded),
proportional_sfs(b_ovatus_HR_one_epoch),
proportional_sfs(b_ovatus_HR_two_epoch),
proportional_sfs(b_ovatus_HR_three_epoch)) +
ggtitle('Bacteroides ovatus (HR) model fit')
compare_sfs(proportional_sfs(b_stercoris_HR_folded),
proportional_sfs(b_stercoris_HR_one_epoch),
proportional_sfs(b_stercoris_HR_two_epoch),
proportional_sfs(b_stercoris_HR_three_epoch)) +
ggtitle('Bacteroides stercoris (HR) model fit')
compare_sfs(proportional_sfs(b_thetaiotaomicron_HR_folded),
proportional_sfs(b_thetaiotaomicron_HR_one_epoch),
proportional_sfs(b_thetaiotaomicron_HR_two_epoch),
proportional_sfs(b_thetaiotaomicron_HR_three_epoch)) +
ggtitle('Bacteroides thetaiotaomicron (HR) model fit')
compare_sfs(proportional_sfs(b_vulgatus_HR_folded),
proportional_sfs(b_vulgatus_HR_one_epoch),
proportional_sfs(b_vulgatus_HR_two_epoch),
proportional_sfs(b_vulgatus_HR_three_epoch)) +
ggtitle('Bacteroides vulgatus (HR) model fit')
compare_sfs(proportional_sfs(d_invisus_HR_folded),
proportional_sfs(d_invisus_HR_one_epoch),
proportional_sfs(d_invisus_HR_two_epoch),
proportional_sfs(d_invisus_HR_three_epoch)) +
ggtitle('Dialister invisus (HR) model fit')
compare_sfs(proportional_sfs(b_intestinihominis_HR_folded),
proportional_sfs(b_intestinihominis_HR_one_epoch),
proportional_sfs(b_intestinihominis_HR_two_epoch),
proportional_sfs(b_intestinihominis_HR_three_epoch)) +
ggtitle('Barnesiella intestinihominis (HR) model fit')
compare_sfs(proportional_sfs(e_rectale_HR_folded),
proportional_sfs(e_rectale_HR_one_epoch),
proportional_sfs(e_rectale_HR_two_epoch),
proportional_sfs(e_rectale_HR_three_epoch)) +
ggtitle('Eubacterium rectale (HR) model fit')
compare_sfs(proportional_sfs(e_siraeum_HR_folded),
proportional_sfs(e_siraeum_HR_one_epoch),
proportional_sfs(e_siraeum_HR_two_epoch),
proportional_sfs(e_siraeum_HR_three_epoch)) +
ggtitle('Eubacterium siraeum (HR) model fit')
compare_sfs(proportional_sfs(oscillibacter_sp_HR_folded),
proportional_sfs(oscillibacter_sp_HR_one_epoch),
proportional_sfs(oscillibacter_sp_HR_two_epoch),
proportional_sfs(oscillibacter_sp_HR_three_epoch)) +
ggtitle('Oscillibacter sp. (HR) model fit')
compare_sfs(proportional_sfs(p_distasonis_HR_folded),
proportional_sfs(p_distasonis_HR_one_epoch),
proportional_sfs(p_distasonis_HR_two_epoch),
proportional_sfs(p_distasonis_HR_three_epoch)) +
ggtitle('Parabacteroides distasonis (HR) model fit')
compare_sfs(proportional_sfs(p_merdae_HR_folded),
proportional_sfs(p_merdae_HR_one_epoch),
proportional_sfs(p_merdae_HR_two_epoch),
proportional_sfs(p_merdae_HR_three_epoch)) +
ggtitle('Parabacteroides merdae (HR) model fit')
compare_sfs(proportional_sfs(r_bicirculans_HR_folded),
proportional_sfs(r_bicirculans_HR_one_epoch),
proportional_sfs(r_bicirculans_HR_two_epoch),
proportional_sfs(r_bicirculans_HR_three_epoch)) +
ggtitle('Ruminococcus bicirculans (HR) model fit')
compare_sfs(proportional_sfs(r_bromii_HR_folded),
proportional_sfs(r_bromii_HR_one_epoch),
proportional_sfs(r_bromii_HR_two_epoch),
proportional_sfs(r_bromii_HR_three_epoch)) +
ggtitle('Ruminococcus bromii (HR) model fit')
## High recombination model fit
a_muciniphila_HR_demography_sfs = compare_sfs(proportional_sfs(a_muciniphila_HR_folded),
proportional_sfs(a_muciniphila_HR_one_epoch),
proportional_sfs(a_muciniphila_HR_two_epoch),
proportional_sfs(a_muciniphila_HR_three_epoch)) +
ggtitle('Akkermansia muciniphila (HR) model fit')
a_finegoldii_HR_demography_sfs = compare_sfs(proportional_sfs(a_finegoldii_HR_folded),
proportional_sfs(a_finegoldii_HR_one_epoch),
proportional_sfs(a_finegoldii_HR_two_epoch),
proportional_sfs(a_finegoldii_HR_three_epoch)) +
ggtitle('Alistipes finegoldii (HR) model fit')
a_onderdonkii_HR_demography_sfs = compare_sfs(proportional_sfs(a_onderdonkii_HR_folded),
proportional_sfs(a_onderdonkii_HR_one_epoch),
proportional_sfs(a_onderdonkii_HR_two_epoch),
proportional_sfs(a_onderdonkii_HR_three_epoch)) +
ggtitle('Alistipes onderdonkii (HR) model fit')
a_shahii_HR_demography_sfs = compare_sfs(proportional_sfs(a_shahii_HR_folded),
proportional_sfs(a_shahii_HR_one_epoch),
proportional_sfs(a_shahii_HR_two_epoch),
proportional_sfs(a_shahii_HR_three_epoch)) +
ggtitle('Alistipes shahii (HR) model fit')
b_caccae_HR_demography_sfs = compare_sfs(proportional_sfs(b_caccae_HR_folded),
proportional_sfs(b_caccae_HR_one_epoch),
proportional_sfs(b_caccae_HR_two_epoch),
proportional_sfs(b_caccae_HR_three_epoch)) +
ggtitle('Bacteroides caccae (HR) model fit')
b_cellulosilyticus_HR_demography_sfs = compare_sfs(proportional_sfs(b_cellulosilyticus_HR_folded),
proportional_sfs(b_cellulosilyticus_HR_one_epoch),
proportional_sfs(b_cellulosilyticus_HR_two_epoch),
proportional_sfs(b_cellulosilyticus_HR_three_epoch)) +
ggtitle('Bacteroides cellulosilyticus (HR) model fit')
b_coprocola_HR_demography_sfs = compare_sfs(proportional_sfs(b_coprocola_HR_folded),
proportional_sfs(b_coprocola_HR_one_epoch),
proportional_sfs(b_coprocola_HR_two_epoch),
proportional_sfs(b_coprocola_HR_three_epoch)) +
ggtitle('Bacteroides copracola (HR) model fit')
b_eggerthii_HR_demography_sfs = compare_sfs(proportional_sfs(b_eggerthii_HR_folded),
proportional_sfs(b_eggerthii_HR_one_epoch),
proportional_sfs(b_eggerthii_HR_two_epoch),
proportional_sfs(b_eggerthii_HR_three_epoch)) +
ggtitle('Bacteroides eggerthii (HR) model fit')
b_fragilis_HR_demography_sfs = compare_sfs(proportional_sfs(b_fragilis_HR_folded),
proportional_sfs(b_fragilis_HR_one_epoch),
proportional_sfs(b_fragilis_HR_two_epoch),
proportional_sfs(b_fragilis_HR_three_epoch)) +
ggtitle('Bacteroides fragilis (HR) model fit')
b_ovatus_HR_demography_sfs = compare_sfs(proportional_sfs(b_ovatus_HR_folded),
proportional_sfs(b_ovatus_HR_one_epoch),
proportional_sfs(b_ovatus_HR_two_epoch),
proportional_sfs(b_ovatus_HR_three_epoch)) +
ggtitle('Bacteroides ovatus (HR) model fit')
b_stercoris_HR_demography_sfs = compare_sfs(proportional_sfs(b_stercoris_HR_folded),
proportional_sfs(b_stercoris_HR_one_epoch),
proportional_sfs(b_stercoris_HR_two_epoch),
proportional_sfs(b_stercoris_HR_three_epoch)) +
ggtitle('Bacteroides stercoris (HR) model fit')
b_thetaiotaomicron_HR_demography_sfs = compare_sfs(proportional_sfs(b_thetaiotaomicron_HR_folded),
proportional_sfs(b_thetaiotaomicron_HR_one_epoch),
proportional_sfs(b_thetaiotaomicron_HR_two_epoch),
proportional_sfs(b_thetaiotaomicron_HR_three_epoch)) +
ggtitle('Bacteroides thetaiotaomicron (HR) model fit')
b_vulgatus_HR_demography_sfs = compare_sfs(proportional_sfs(b_vulgatus_HR_folded),
proportional_sfs(b_vulgatus_HR_one_epoch),
proportional_sfs(b_vulgatus_HR_two_epoch),
proportional_sfs(b_vulgatus_HR_three_epoch)) +
ggtitle('Bacteroides vulgatus (HR) model fit')
d_invisus_HR_demography_sfs = compare_sfs(proportional_sfs(d_invisus_HR_folded),
proportional_sfs(d_invisus_HR_one_epoch),
proportional_sfs(d_invisus_HR_two_epoch),
proportional_sfs(d_invisus_HR_three_epoch)) +
ggtitle('Dialister invisus (HR) model fit')
b_intestinihominis_HR_demography_sfs = compare_sfs(proportional_sfs(b_intestinihominis_HR_folded),
proportional_sfs(b_intestinihominis_HR_one_epoch),
proportional_sfs(b_intestinihominis_HR_two_epoch),
proportional_sfs(b_intestinihominis_HR_three_epoch)) +
ggtitle('Barnesiella intestinihominis (HR) model fit')
e_rectale_HR_demography_sfs = compare_sfs(proportional_sfs(e_rectale_HR_folded),
proportional_sfs(e_rectale_HR_one_epoch),
proportional_sfs(e_rectale_HR_two_epoch),
proportional_sfs(e_rectale_HR_three_epoch)) +
ggtitle('Eubacterium rectale (HR) model fit')
e_siraeum_HR_demography_sfs = compare_sfs(proportional_sfs(e_siraeum_HR_folded),
proportional_sfs(e_siraeum_HR_one_epoch),
proportional_sfs(e_siraeum_HR_two_epoch),
proportional_sfs(e_siraeum_HR_three_epoch)) +
ggtitle('Eubacterium siraeum (HR) model fit')
oscillibacter_sp_HR_demography_sfs = compare_sfs(proportional_sfs(oscillibacter_sp_HR_folded),
proportional_sfs(oscillibacter_sp_HR_one_epoch),
proportional_sfs(oscillibacter_sp_HR_two_epoch),
proportional_sfs(oscillibacter_sp_HR_three_epoch)) +
ggtitle('Oscillibacter sp. (HR) model fit')
p_distasonis_HR_demography_sfs = compare_sfs(proportional_sfs(p_distasonis_HR_folded),
proportional_sfs(p_distasonis_HR_one_epoch),
proportional_sfs(p_distasonis_HR_two_epoch),
proportional_sfs(p_distasonis_HR_three_epoch)) +
ggtitle('Parabacteroides distasonis (HR) model fit')
p_merdae_HR_demography_sfs = compare_sfs(proportional_sfs(p_merdae_HR_folded),
proportional_sfs(p_merdae_HR_one_epoch),
proportional_sfs(p_merdae_HR_two_epoch),
proportional_sfs(p_merdae_HR_three_epoch)) +
ggtitle('Parabacteroides merdae (HR) model fit')
r_bicirculans_HR_demography_sfs = compare_sfs(proportional_sfs(r_bicirculans_HR_folded),
proportional_sfs(r_bicirculans_HR_one_epoch),
proportional_sfs(r_bicirculans_HR_two_epoch),
proportional_sfs(r_bicirculans_HR_three_epoch)) +
ggtitle('Ruminococcus bicirculans (HR) model fit')
r_bromii_HR_demography_sfs = compare_sfs(proportional_sfs(r_bromii_HR_folded),
proportional_sfs(r_bromii_HR_one_epoch),
proportional_sfs(r_bromii_HR_two_epoch),
proportional_sfs(r_bromii_HR_three_epoch)) +
ggtitle('Ruminococcus bromii (HR) model fit')
a_muciniphila_HR_demography_sfs +
a_finegoldii_HR_demography_sfs +
a_onderdonkii_HR_demography_sfs +
a_shahii_HR_demography_sfs +
plot_layout(ncol=1)
