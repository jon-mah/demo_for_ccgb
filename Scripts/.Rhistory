for (i in 1:length(shared_species_list)) {
# nu_mle
## HR
shared_species_df[i, 2] = return_nu_mle(hr_likelihood_surface_list[i])
## FD
shared_species_df[i, 3] = return_nu_mle(fd_shared_likelihood_surface_list[i])
# tau_mle
## HR
shared_species_df[i, 4] = return_time_mle(hr_likelihood_surface_list[i],
hr_sfs_list[i],
hr_demography_file_list[i])
## FD
shared_species_df[i, 5] = return_time_mle(fd_shared_likelihood_surface_list[i],
fd_shared_sfs_list[i],
fd_shared_demography_file_list[i])
# Tau
shared_species_df[i, 6] = return_tau_mle(hr_likelihood_surface_list[i])
shared_species_df[i, 7] = return_tau_mle(fd_shared_likelihood_surface_list[i])
# Nanc
## HR
shared_species_df[i, 8] = nanc_from_demography(hr_demography_file_list[i])
## FD
shared_species_df[i, 9] = nanc_from_demography(fd_shared_demography_file_list[i])
# shape
## HR
shared_species_df[i, 10] = return_shape_from_dfe(hr_dfe_file_list[i])
## FD
shared_species_df[i, 11] = return_shape_from_dfe(fd_shared_dfe_file_list[i])
# scale
## HR
shared_species_df[i, 12] = return_scale_from_dfe(hr_dfe_file_list[i])
## FD
shared_species_df[i, 13] = return_scale_from_dfe(fd_core_dfe_file_list[i])
# Mean s
## HR
shared_species_df[i, 14] = mean(read_dfe_params(hr_dfe_file_list[i])$gamma_dfe_dist_high)
## FD
shared_species_df[i, 15] = mean(read_dfe_params(fd_shared_dfe_file_list[i])$gamma_dfe_dist_high)
# Allele sum
## HR
shared_species_df[i, 16] = return_allele_sum(hr_sfs_list[i])
## FD
shared_species_df[i, 17] = return_allele_sum(fd_shared_sfs_list[i])
}
shared_species_df
shared_species_df$species = factor(shared_species_df$species, levels=HR_phylogenetic_levels)
shared_species_df <- shared_species_df[order(shared_species_df$species), ]
shared_species_df
shared_species_df$HR_2ns = shared_species_df$HR_nanc * 2 * shared_species_df$HR_mean_s
shared_species_df$FD_2ns = shared_species_df$FD_nanc * 2 * shared_species_df$FD_mean_s
HR_FD_nu_mle_scatter = ggscatter(shared_species_df, x="FD_nu_mle", y="HR_nu_mle", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E-2, 1E4)) +
scale_y_log10(limits=c(1E-2, 1E4)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Nu')
HR_FD_nu_mle_scatter
HR_FD_time_mle_scatter = ggscatter(shared_species_df, x="FD_time_mle", y="HR_time_mle", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E2, 1E6)) +
scale_y_log10(limits=c(1E2, 1E6)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Time (years)')
HR_FD_time_mle_scatter
HR_FD_tau_mle_scatter = ggscatter(shared_species_df, x="FD_tau_mle", y="HR_tau_mle", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E-1, 1E4)) +
scale_y_log10(limits=c(1E-1, 1E4)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of tau')
HR_FD_tau_mle_scatter
HR_FD_nanc_scatter = ggscatter(shared_species_df, x="FD_nanc", y="HR_nanc", color='species', size=3) +
ylab('High recombination data') +
xlab('Full data') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(3E6, 3E8)) +
scale_y_log10(limits=c(3E6, 3E8)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Effective ancestral population size')
HR_FD_nanc_scatter
HR_FD_shape_scatter = ggscatter(shared_species_df, x="FD_shape", y="HR_shape", color='species', size=3) +
ylab('Low recombination sites removed') +
xlab('Full SFS') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(0.003, 2.00)) +
scale_y_log10(limits=c(0.003, 2.00)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE shape parameter')
HR_FD_shape_scatter
HR_FD_scale_scatter = ggscatter(shared_species_df, x="FD_scale", y="HR_scale", color='species', size=3) +
ylab('Low recombination sites removed') +
xlab('Full SFS') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E-14, 1E3)) +
scale_y_log10(limits=c(1E-14, 1E3)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE scale parameter')
HR_FD_scale_scatter
HR_FD_mean_s_scatter = ggscatter(shared_species_df, x="FD_mean_s", y="HR_mean_s", color='species', size=3) +
ylab('Low recombination sites removed') +
xlab('Full SFS') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E-14, 1E3)) +
scale_y_log10(limits=c(1E-14, 1E3)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE mean selection coefficient')
HR_FD_mean_s_scatter
HR_FD_2ns_scatter = ggscatter(shared_species_df, x="FD_2ns", y="HR_2ns", color='species', size=3) +
ylab('Low recombination sites removed') +
xlab('Full SFS') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(1E-8, 1E10)) +
scale_y_log10(limits=c(1E-8, 1E10)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Estimated 2ns of gamma-distributed DFE')
HR_FD_2ns_scatter
HR_FD_allele_count_scatter = ggscatter(shared_species_df, x="FD_allele_sum", y="HR_allele_sum", color='species', size=3) +
ylab('Low recombination sites removed') +
xlab('Full SFS') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10(limits=c(9E4, 5E5)) +
scale_y_log10(limits=c(9E4, 5E5)) +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Number of sites included in SFS')
HR_FD_allele_count_scatter
HR_FD_nu_mle_scatter + HR_FD_time_mle_scatter +
HR_FD_nanc_scatter + HR_FD_allele_count_scatter +
HR_FD_mean_s_scatter + HR_FD_2ns_scatter +
HR_FD_shape_scatter + HR_FD_scale_scatter +
plot_layout(ncol=2)
HR_FD_2ns_scatter + HR_FD_mean_s_scatter +
HR_FD_scale_scatter + HR_FD_shape_scatter +
plot_layout(ncol=2)
# Accessory vs. Core (FD)
supplementary_species_df = data.frame(species=supplementary_species_list,
FD_accessory_nu_mle = numeric(39),
FD_core_nu_mle = numeric(39),
FD_accessory_time_mle = numeric(39),
FD_core_time_mle = numeric(39),
FD_accessory_tau_mle = numeric(39),
FD_core_tau_mle = numeric(39),
FD_accessory_nanc = numeric(39),
FD_core_nanc = numeric(39),
FD_accessory_shape = numeric(39),
FD_core_shape = numeric(39),
FD_accessory_scale = numeric(39),
FD_core_scale = numeric(39),
FD_accessory_mean_s = numeric(39),
FD_core_mean_s = numeric(39)
)
for (i in 1:length(supplementary_species_list)) {
# nu_mle
## HR
supplementary_species_df[i, 2] = return_nu_mle(fd_accessory_likelihood_surface_list[i])
## FD
supplementary_species_df[i, 3] = return_nu_mle(fd_core_likelihood_surface_list[i])
# tau_mle
## HR
supplementary_species_df[i, 4] = return_time_mle(fd_accessory_likelihood_surface_list[i],
fd_accessory_sfs_list[i],
fd_accessory_demography_file_list[i])
## FD
supplementary_species_df[i, 5] = return_time_mle(fd_core_likelihood_surface_list[i],
fd_core_sfs_list[i],
fd_core_demography_file_list[i])
# Tau
supplementary_species_df[i, 6] = return_tau_mle(fd_accessory_likelihood_surface_list[i])
supplementary_species_df[i, 7] = return_tau_mle(fd_core_likelihood_surface_list[i])
# Nanc
## HR
supplementary_species_df[i, 8] = nanc_from_demography(fd_accessory_demography_file_list[i])
## FD
supplementary_species_df[i, 9] = nanc_from_demography(fd_core_demography_file_list[i])
# shape
## HR
supplementary_species_df[i, 10] = return_shape_from_dfe(fd_accessory_dfe_file_list[i])
## FD
supplementary_species_df[i, 11] = return_shape_from_dfe(fd_core_dfe_file_list[i])
# scale
## HR
supplementary_species_df[i, 12] = return_scale_from_dfe(fd_accessory_dfe_file_list[i])
## FD
supplementary_species_df[i, 13] = return_scale_from_dfe(fd_core_dfe_file_list[i])
# Mean s
## HR
supplementary_species_df[i, 14] = mean(read_dfe_params(fd_accessory_dfe_file_list[i])$gamma_dfe_dist_high)
## FD
supplementary_species_df[i, 15] = mean(read_dfe_params(fd_core_dfe_file_list[i])$gamma_dfe_dist_high)
}
supplementary_species_df
supplementary_species_df$species = factor(supplementary_species_df$species, levels=FD_phylogenetic_levels)
supplementary_species_df <- supplementary_species_df[order(supplementary_species_df$species), ]
supplementary_species_df
FD_accessory_core_nu_mle_scatter = ggscatter(supplementary_species_df, x="FD_core_nu_mle", y="FD_accessory_nu_mle", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Nu')
FD_accessory_core_nu_mle_scatter
FD_accessory_core_time_mle_scatter = ggscatter(supplementary_species_df, x="FD_core_time_mle", y="FD_accessory_time_mle", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of Time (years)')
FD_accessory_core_time_mle_scatter
FD_accessory_core_tau_mle_scatter = ggscatter(supplementary_species_df, x="FD_core_tau_mle", y="FD_accessory_tau_mle", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Maximum likelihood estimate of tau')
FD_accessory_core_tau_mle_scatter
FD_accessory_core_nanc_scatter = ggscatter(supplementary_species_df, x="FD_core_nanc", y="FD_accessory_nanc", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Effective ancestral population size')
FD_accessory_core_nanc_scatter
FD_accessory_core_shape_scatter = ggscatter(supplementary_species_df, x="FD_core_shape", y="FD_accessory_shape", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE shape parameter')
FD_accessory_core_shape_scatter
FD_accessory_core_scale_scatter = ggscatter(supplementary_species_df, x="FD_core_scale", y="FD_accessory_scale", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE scale parameter')
FD_accessory_core_scale_scatter
FD_accessory_core_mean_s_scatter = ggscatter(supplementary_species_df, x="FD_core_mean_s", y="FD_accessory_mean_s", color='species', size=3) +
ylab('Full data (accessory genome)') +
xlab('Full data (core genome)') +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=4) +
scale_x_log10() +
scale_y_log10() +
guides(color=guide_legend(title="species")) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none') +
geom_abline(slope=1, intercept=0) +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16)) +
ggtitle('Gamma-distributed DFE mean selection coefficient')
FD_accessory_core_mean_s_scatter
# Delta n_Anc
delta_nanc_df = data.frame(shared_species_df$species, shared_species_df$FD_nanc - shared_species_df$HR_nanc)
names(delta_nanc_df) = c('species', 'delta_nanc')
delta_nanc_df
ggplot(delta_nanc_df, aes(x = reorder(species, delta_nanc), y=delta_nanc)) +
geom_bar(stat = 'identity') +
labs(title = 'Change in estimated ancestral effective population size',
x='Species',
y='Delta N_Anc when removing low recombination sites') +
coord_flip() +
theme_minimal()
recombination_percentiles_df = read.csv('../HighRecombinationAnalysis/recombination_percentiles.csv', header = TRUE)
recombination_percentiles_df
recombination_percentiles_df$ratio = recombination_percentiles_df$third_quartile / recombination_percentiles_df$first_quartile
recombination_percentiles_df
ggplot(recombination_percentiles_df, aes(x=reorder(species, ratio), y=first_quartile)) +
geom_bar(stat = 'identity') +
labs(title = 'First quartile of recombination rate by species',
x='Species',
y='Recombination events / base pair of core genome') +
coord_flip() +
ylim(0, 0.03) +
theme_minimal()
ggplot(recombination_percentiles_df, aes(x=reorder(species, ratio), y=median)) +
geom_bar(stat = 'identity') +
labs(title = 'Median recombination rate by species',
x='Species',
y='Recombination events / base pair of core genome') +
coord_flip() +
ylim(0, 0.03) +
theme_minimal()
ggplot(recombination_percentiles_df, aes(x=reorder(species, ratio), y=third_quartile)) +
geom_bar(stat = 'identity') +
labs(title = 'Third quartile of recombination rate by species',
x='Species',
y='Recombination events / base pair of core genome') +
coord_flip() +
ylim(0, 0.03) +
theme_minimal()
ggplot(recombination_percentiles_df, aes(x=reorder(species, ratio), y=ratio)) +
geom_bar(stat = 'identity') +
labs(title = '75th percentile divided by 25th percentile recombination rate by species',
x='Species',
y='Ratio of third and first quantile recombination rates') +
coord_flip() +
theme_minimal()
# Plot DFE Grid
DFE_grid_file_list = c(
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_sp_60764_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_eggerthii_54457_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_massiliensis_44749_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_plebeius_61623_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_coprocola_61586_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Roseburia_inulinivorans_61943_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Roseburia_intestinalis_56239_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Lachnospiraceae_bacterium_51870_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Coprococcus_sp_62244_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_siraeum_57634_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_62201_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_61481_likelihood_surface.csv'
)
# for (species in DFE_grid_file_list) {
#   print(species)s
#   find_dfe_mle(species)
# }
#
# cross_species_dfe_comparison(
#   DFE_grid_file_list[1],
#   DFE_grid_file_list[2]
# )
# dfe_comparison_matrix = matrix(, nrow=39, ncol=39)
#
# for (i in 1:39) {
#   for (j in i:39) {  # This change ensures only the upper right triangle is compared
#     print(DFE_grid_file_list[i])
#     print(DFE_grid_file_list[j])
#     comparison = cross_species_dfe_comparison(DFE_grid_file_list[i], DFE_grid_file_list[j])
#     print(comparison)
#     dfe_comparison_matrix[i, j] = comparison
#     dfe_comparison_matrix[j, i] = comparison  # Mirror the value across the diagonal
#   }
# }
DFE_grid_file_list_constant_s = c(
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_sp_60764_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_finegoldii_56071_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_onderdonkii_55464_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_shahii_62199_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Alistipes_putredinis_61533_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroidales_bacterium_58650_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Odoribacter_splanchnicus_62174_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Parabacteroides_distasonis_56985_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Parabacteroides_merdae_56972_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Prevotella_copri_61740_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_fragilis_54507_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_eggerthii_54457_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_stercoris_56735_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_uniformis_57318_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_caccae_53434_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_massiliensis_44749_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_vulgatus_57955_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_plebeius_61623_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Bacteroides_coprocola_61586_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Barnesiella_intestinihominis_62208_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Akkermansia_muciniphila_55290_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Dialister_invisus_61905_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Phascolarctobacterium_sp_59817_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_eligens_61678_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_rectale_56927_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Roseburia_inulinivorans_61943_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Roseburia_intestinalis_56239_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Lachnospiraceae_bacterium_51870_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Coprococcus_sp_62244_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Oscillibacter_sp_60799_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Ruminococcus_bromii_62047_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Ruminococcus_bicirculans_59300_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Eubacterium_siraeum_57634_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_62201_constant_s_likelihood_surface.csv',
'../SupplementaryAnalysis/cross_species_dfe/Faecalibacterium_prausnitzii_61481_constant_s_likelihood_surface.csv'
)
for (species in DFE_grid_file_list_constant_s) {
print(species)
find_dfe_mle(species)
}
